# Jupyter Notebook of the paper entitled "From Pairwise to Higher-order Clustering: A (Hyper-)graph Signal Processing Approach on Brain Functional Connectivity Analysis"

Authors: Breno Bispo, José Neto, Juliano Lima and Fernando Santos 

Contact information: <juliano.lima@ufpe.br> or <f.a.nobregasantos@uva.nl>

## Table of contents
1. [General information](#general_information)
2. [Requirements](#requirements)
3. [Content](#content)
4. [Citation](#citation)
5. [Acknowledgements](#acknowledgements)


### <a id='general_information'></a> General information:

 The primary purpose of this project is to reproduce the results depicted in the paper entitled "From Pairwise to Higher-order Clustering: A (Hyper-)graph Signal Processing Approach on Brain Functional Connectivity Analysis".

### <a id='content'></a> Content:

This folder consist in the following folders / files:

- **t_hgsp_fmri.ipynb**: the main Jupyter Notebook that reproduce the results presented in the paper;
- **df_peak_ii_tc_0_4_zscore_mean_tubal_scalars.pkl**: a Pandas Dataframe that consists of peak values at $k=0,4$ of the tubal scalars average of $\left(\widehat{\mathcal{M}_1}_s^{abs}\right)^{[n]}, \left(\widehat{\mathcal{T}_1}_s^{abs}\right)^{[n]}, \left(\widehat{\mathcal{M}_2}_s^{abs}\right)^{[n]}, \left(\widehat{\mathcal{T}_2}_s^{abs}\right)^{[n]}$ for each $n$-individual brain hypergraph;
- **Background_Scripts**: a folder that consists of auxiliary Python modules related to (H-)GSP tools, clustering algorithms and plotting functions;
- **Schaefer_100Parcels_Atlas**: a folder that consists of spacial coordinates, region names/colors, subnet names/colors, etc, of the 116 regions-of-interest (ROIs) of the brain (based on the Schaefer's brain atlas https://doi.org/10.1093/cercor/bhx179), the averaged correlation matrix $\mathbf{A}$ (given by the average of $\mathbf{A}^{[0,1,\cdots,1977]}$), and the averaged zscored hyperedges weights of the triplets using *interaction information* ($II$) and *total correlation* ($TC$) metrics;
- **Binarized_Adjacency_Matrices**: a folder that consists of binarized adjacency matrices of $\mathcal{G}$, $\mathcal{G}^{(0)}\_{II}$, $\mathcal{G}^{(0)}\_{TC}$, $\mathcal{G}^{(4)}\_{II}$, $\mathcal{G}^{(4)}\_{TC}$ (for different values of density $D \in \\{0\\%,5\\%,15\\%,20\\%\\}$), with rows and columns ordered based on the clustering outcomes;
- **Figures**: a folder that consists of a 3D brain object for plotting purposes and files related to the results generated by the Jupyter Notebook.

### <a id='requirements'></a> Usage and Requirements:

This project uses **Anaconda and Python version 3.7**. In this way, we recommend creating a new environment in Anaconda dedicated for the use of this notebook (primarly tested on Windows) following the instructions provided in this repository: https://github.com/multinetlab-amsterdam/network_TDA_tutorial.git.

To install these dependencies, follow these steps:

1. Activate the new environment in the command line (Anaconda prompt):

```bash
conda activate envname
```

You should now see the name of your virtual environment in your terminal prompt, indicating that the virtual environment is active.

2. Change to the notebook's directory:

```bash
cd path\to\notebookfolder
```

2. Install the required packages:

** with environment-specific python.exe (Windows)
```bash
path\to\anaconda3\envs\envname\python.exe -m pip install -r requirements.txt
```
** MacOS users do not need to give the path to the environment's python.exe
```bash
pip install -r requirements.txt
```

This command will install all the packages listed in `requirements.txt`:

  - meshio      : 4.0.16
  - scikit-learn: 1.0.2
  - jupyterlab  : 3.3.4
  - notebook    : 6.5.2
  - networkx  : 2.6.3
  - karateclub: 1.3.3
  - seaborn   : 0.11.0
  - scipy     : 1.5.0
  - matplotlib: 3.3.2
  - numpy     : 1.18.5
  - plotly    : 4.6.0
  - pandas    : 1.1.3


Now, you are ready to run the project.
     

### <a id='citation'></a> Citation:

Here are some of the key papers where the data visualisation of this project is based on:

- [Centeno, E. G. Z., Moreni, G., Vriend, C., Douw, L., & Santos, F. A. N. (2022). A hands-on tutorial on network and topological neuroscience. Brain Structure and Function, 227(3), 741-762.](https://link.springer.com/article/10.1007/s00429-021-02435-0)

- [Santos, F. A., Tewarie, P. K., Baudot, P., Luchicchi, A., Barros de Souza, D. A., Girier, G., ... & Quax, R. (2023). Emergence of High-Order Functional Hubs in the Human Brain. bioRxiv, 2023-02.](https://www.biorxiv.org/content/10.1101/2023.02.10.528083v1)


### <a id='acknowledgements'></a>Acknowledgements:

- Breno C. Bispo would like to acknowledge support from Dutch Institute for Emergent Phenomena (DIEP), Institute for Advanced Studies at University of Amsterdam;

- This work was supported in part by Conselho Nacional de Desenvolvimento Científico e Tecnológico (CNPq) under grants 140151/2022-2, 442238/2023-1, 312935/2023-4 and 405903/2023-5, Coordenação de Aperfeiçoamento de Pessoal de Nível Superior (CAPES) under grant 88881.311848/2018-01, 88887.899136/2023-00, and Fundação de Amparo à Ciência e Tecnologia do Estado de Pernambuco (FACEPE) under grant APQ-1226-3.04/22.